# ZXO 戒烟打卡应用 - 产品需求文档（PRD）

**版本号：** v2.0  
**最后更新：** 2025年12月1日  
**产品类型：** Web 应用 / 小程序  
**设计语言：** 浅色主题 + 中文黑体 + 绿色点缀

---

## 一、产品概述

### 1.1 产品定位
ZXO 是一款以"游戏化段位晋升"为核心激励机制的戒烟打卡应用，通过每日打卡、补签卡系统、9段位星级体系、烟瘾记录曲线和数据可视化，帮助用户科学戒烟、持续坚持。

### 1.2 核心价值
- **游戏化激励**：借鉴游戏段位系统，让戒烟过程充满成就感
- **数据可视化**：直观展示戒烟成果（节省金额、少抽根数、多活时间等）
- **补签机制**：降低中断焦虑，提升用户留存
- **权限差异化**：免费/VIP/SVIP 三档权限，满足不同用户需求

### 1.3 设计理念
- **浅色主题**：白色背景（#EFEFEF）+ 黑色文本（#2A2A2A）+ 绿色点缀（#00B894）
- **中文黑体**：统一字体风格，数字全部加粗显示
- **极简交互**：核心功能一键触达，减少操作步骤

---

## 二、目标用户

### 2.1 用户画像
- **年龄层**：25-45 岁成年烟民
- **戒烟动机**：健康、省钱、家庭压力、社会认同
- **使用场景**：每日早晨/晚间打卡，烟瘾发作时记录，偶尔查看数据报告

### 2.2 用户需求
- **坚持激励**：需要外部激励系统（段位、数据、排名）维持动力
- **容错机制**：需要补签卡等机制避免"一次中断全盘皆输"的挫败感
- **成果可视化**：希望看到戒烟带来的实际收益（金钱、健康）
- **社交分享**：通过分享海报获得认可和鼓励

---

## 三、核心功能模块

### 3.1 页面结构
```
ZXO 应用
├── 开屏页（SplashScreen）
├── 首页（HomePage）
├── 首次设置弹窗（FirstTimeSetup）
├── 成就等级页（AchievementsPage）
├── 连续打卡日历页（CheckInCalendar）
├── 分享海报页（SharePoster）
├── 数据报告页（DataReportPage）
├── 健康报告页（HealthReportPage）
├── 设置页（SettingsPage）
├── 排行榜页（RankingPage）
└── AI 助手页（AIAssistantPage）
```

### 3.2 核心系统
1. **段位系统**：9 段位星级体系（倔强青铜→传奇王者）
2. **补签卡系统**：初始 3 张，每 7 天连续打卡奖励 1 张
3. **权限系统**：免费/VIP/SVIP 三种权限，通过兑换码切换
4. **数据统计**：6 项核心数据 + 等价物兑换 + 健康改善指标

---

## 四、功能模块详细说明

### 4.1 开屏页（SplashScreen）

**功能描述**
- 应用启动时展示 3 秒品牌 Logo 和标语
- 自动跳转至首页

**设计要点**
- 浅色背景 + ZXO 品牌 Logo
- 简洁动画效果

---

### 4.2 首页（HomePage）

**功能描述**
- 展示用户头像、昵称、段位徽章
- 展示 6 项核心数据
- 提供打卡按钮、烟瘾记录按钮
- 快捷入口：成就等级、连续打卡、分享海报、数据报告、设置、排行榜

**6 项核心数据**
1. **戒烟总天数**：累计打卡天数（包含补签）
2. **连续天数**：最近连续打卡天数（含补签）
3. **少抽根数**：总天数 × 每日吸烟量
4. **节约金额**：少抽根数 ÷ 每包根数 × 每包价格
5. **等价物兑换**：根据节约金额计算可兑换物品（可乐、电影票、游戏机等）
6. **多活时间**：少抽根数 × 11 分钟（每根烟减少约 11 分钟寿命）

**段位徽章**
- 显示当前段位名称（如"荣耀黄金"）
- 显示段位星级（如 15 星）
- 点击跳转至成就等级页

**打卡按钮**
- 今日未打卡：绿色按钮，显示"今日打卡"
- 今日已打卡：灰色禁用状态，显示"今日已打卡"
- 首次打卡自动触发首次设置弹窗

**烟瘾记录按钮**
- 点击 ZXO Logo（右上角）记录烟瘾
- 10 分钟内重复点击不重复记录
- 连续三次点击跳转至数据报告页

**本地排名展示**
- 显示"朝阳区排名第 5 名"（示例）
- 点击跳转至排行榜页

**AI 助手入口**
- 仅对 VIP/SVIP 用户显示（VIP 含 4 天体验期）
- 点击进入 AI 对话页面

**交互逻辑**
1. 首次进入无打卡记录 → 点击打卡 → 触发首次设置弹窗 → 填写吸烟数据 → 完成首次打卡 → 跳转分享海报页
2. 非首次打卡 → 点击打卡 → 播放咔嗒音效 → 判断是否晋升段位 → 跳转分享海报页
3. 点击 ZXO Logo → 播放音效 → 记录烟瘾（10 分钟限制）→ 三次点击跳转数据报告

---

### 4.3 首次设置弹窗（FirstTimeSetup）

**功能描述**
- 首次打卡时弹出，收集用户吸烟数据
- 包含用户协议同意选项

**数据字段**
1. **吸烟年限**：下拉选择（1年以下、1-3年、3-5年、5-10年、10年以上）
2. **每日吸烟量**：输入框，默认 20 根
3. **每包价格**：输入框，默认 20 元
4. **每包根数**：输入框，默认 20 根

**协议内容**
- 用户协议：说明应用功能、数据使用、隐私保护
- 必须勾选同意才能完成设置

**交互逻辑**
1. 填写数据 → 勾选同意协议 → 点击"开始戒烟之旅" → 保存数据 → 自动完成首次打卡 → 跳转分享海报页

---

### 4.4 成就等级页（AchievementsPage）

**功能描述**
- 展示 9 段位星级体系
- 高亮显示当前段位
- 展示每个段位的天数范围、星级范围、鼓励文案

**9 段位体系**

| 段位 | 天数范围 | 星级范围 | 时期 | 晋升文案 |
|------|----------|----------|------|----------|
| 倔强青铜 | 1-7 天 | 1-7 星 | 第 1 周 | 加油！争取成功度过最难熬的头 7 天。每天不吸烟就是一场胜利。 |
| 秩序白银 | 8-30 天 | 1-23 星 | 第 2 周-第 1 个月 | 身体开始清除尼古丁，习惯开始被打破。坚持每天打卡。 |
| 荣耀黄金 | 31-60 天 | 1-30 星 | 第 2 个月 | 生理依赖显著减弱。坚持一个月不吸烟，值得一枚"金牌"。 |
| 尊贵铂金 | 61-90 天 | 1-30 星 | 第 3 个月 | 恭喜！你已成功克服了最强烈的生理依赖，戒烟习惯初步形成。 |
| 永恒钻石 | 91-180 天 | 1-90 星 | 第 4-6 个月 | 名声在外的"钻石坑"，极易因心瘾和诱惑而"掉星"（复吸）。稳住心态！ |
| 至尊星耀 | 181-270 天 | 1-90 星 | 第 7-9 个月 | 已经半年多不吸烟，信心大增。但依然不能松懈。 |
| 最强王者 | 271-365 天 | 1-95 星 | 第 10 个月-1 年 | 里程碑达成！坚持戒烟满一年，你已经是生活中的"王者"。 |
| 无双王者 | 366-547 天 | 1-182 星 | 第 1 年-1 年半 | 对烟草的渴望已非常微弱，在各种场合都能坦然拒绝敬烟。 |
| 传奇王者 | 548 天+ | 1 星+ | 第 1 年半-2 年及以上 | 登顶！你不再是一个"戒烟者"，而是一个"不吸烟的人"。 |

**星级计算规则**
- 倔强青铜：星级 = 天数（1-7 星）
- 秩序白银：星级 = 天数 - 7（1-23 星）
- 荣耀黄金：星级 = 天数 - 30（1-30 星）
- 尊贵铂金：星级 = 天数 - 60（1-30 星）
- 永恒钻石：星级 = 天数 - 90（1-90 星）
- 至尊星耀：星级 = 天数 - 180（1-90 星）
- 最强王者：星级 = 天数 - 270（1-95 星）
- 无双王者：星级 = 天数 - 365（1-182 星）
- 传奇王者：星级 = 天数 - 547（1 星+）

**交互逻辑**
- 当前段位高亮显示（绿色边框）
- 可滚动查看所有段位
- 点击返回按钮回到首页

---

### 4.5 连续打卡日历页（CheckInCalendar）

**功能描述**
- 展示月历视图，标记已打卡日期
- 展示当前补签卡数量
- 提供补签功能

**日历展示**
- 已打卡日期：绿色圆点标记
- 补签日期：橙色圆点标记
- 未打卡日期：无标记
- 今日日期：加粗边框

**补签卡系统**
- 初始赠送：新用户赠送 3 张
- 获取方式：每连续打卡 7 天奖励 1 张
- 使用限制：每日最多补签 2 天
- 补签范围：只能补签过去的日期，不能补签未来

**补签规则**
1. 检查补签卡数量 ≥ 1
2. 检查该日期未打卡
3. 检查今日补签次数 < 2
4. 消耗 1 张补签卡
5. 添加补签记录（标记为补签）
6. 重新计算连续天数
7. 检查是否晋升段位

**连续天数计算**
- 从今天开始往前推算，连续打卡（含补签）的天数
- 中间任何一天缺失则中断

**交互逻辑**
1. 点击未打卡日期 → 弹出补签确认 → 消耗补签卡 → 更新日历 → 显示补签成功提示
2. 连续打卡 7 天 → 自动奖励 1 张补签卡 → 显示奖励提示

---

### 4.6 分享海报页（SharePoster）

**功能描述**
- 展示用户戒烟成果海报
- 支持下载和分享
- 根据权限差异化显示排名信息

**海报内容**
1. **用户信息**：头像、昵称
2. **段位徽章**：当前段位 + 星级
3. **核心数据**：戒烟天数、节省金额、等价物、多活时间
4. **7 天打卡记录**：最近 7 天打卡状态（绿色/灰色圆点）
5. **排名信息**：
   - **普通用户**：
     - 第一行：朝阳区排名第 5 名（黑色文字 + 橙色数字）
     - 第二行：🔒 全国排名未开通 · 开通 VIP 可查看（橙色小字）
   - **VIP/SVIP 用户**：
     - 全国排名第 X 名
     - 超越全国 XX% 用户
6. **品牌水印**：ZXO Logo

**海报样式**
- 白色卡片背景（#FFFFFF）
- 绿色点缀（#00B894）
- 橙色提示（#F59E0B）用于未开通功能
- 中文黑体，数字加粗

**操作功能**
- 下载海报：保存为图片
- 分享海报：调用系统分享
- 返回首页

**交互逻辑**
1. 打卡成功 → 自动跳转分享海报页
2. 点击首页"分享海报"入口 → 跳转分享海报页
3. 点击下载/分享按钮 → 生成图片 → 保存/分享

---

### 4.7 数据报告页（DataReportPage）

**功能描述**
- 可视化展示烟瘾记录曲线
- 统计烟瘾发作时段分布
- 展示戒烟成果数据
- 提供烟瘾记录按钮

**烟瘾记录曲线**
- **横轴**：最近 7 天日期
- **纵轴**：每日烟瘾记录次数
- **图表类型**：柱状图 + 折线图
- **数据来源**：用户点击 ZXO Logo 记录的烟瘾数据

**时段分布**
- 统计烟瘾发作的高峰时段（如 9:00-12:00、14:00-17:00）
- 柱状图展示 24 小时烟瘾分布

**成果数据**
- 戒烟总天数
- 少抽根数
- 节约金额
- 等价物兑换

**烟瘾记录按钮**
- 仅今日已打卡用户可见
- 点击记录烟瘾 → 10 分钟内不重复记录 → 更新曲线

**交互逻辑**
1. 点击首页 ZXO Logo 三次 → 跳转数据报告页
2. 点击首页"数据报告"入口 → 跳转数据报告页
3. 点击"查看健康报告" → 跳转健康报告页

---

### 4.8 健康报告页（HealthReportPage）

**功能描述**
- 展示戒烟后的身体恢复进度
- 基于戒烟天数展示健康改善里程碑

**健康改善时间线**
| 时间节点 | 健康改善 |
|----------|----------|
| 20 分钟 | 心率和血压下降至正常水平 |
| 12 小时 | 血液中一氧化碳浓度恢复正常 |
| 2 周-3 个月 | 肺功能开始改善，循环系统好转 |
| 1-9 个月 | 咳嗽和呼吸急促减少 |
| 1 年 | 冠心病风险降低 50% |
| 5 年 | 中风风险降低至非吸烟者水平 |
| 10 年 | 肺癌死亡率降低约 50% |
| 15 年 | 冠心病风险降低至非吸烟者水平 |

**数据展示**
- 已达成的里程碑：绿色勾选图标
- 未达成的里程碑：灰色未勾选图标
- 当前进度条：显示距离下一个里程碑的天数

**交互逻辑**
- 从数据报告页点击"查看健康报告"进入
- 点击返回按钮回到数据报告页

---

### 4.9 设置页（SettingsPage）

**功能描述**
- 展示用户信息（头像、昵称、段位）
- 修改吸烟数据
- 输入兑换码切换权限
- 查看健康报告
- 其他设置项

**用户信息**
- 头像、昵称：静态展示（暂不支持修改）
- 当前段位 + 星级

**修改吸烟数据**
- 点击"修改吸烟数据"按钮 → 弹出表单 → 修改吸烟年限、每日吸烟量、每包价格、每包根数 → 保存 → 重新计算所有数据

**兑换码系统**
- 输入框：输入兑换码
- 兑换按钮：点击验证
- 三种兑换码：
  - **ZXO**：切换为普通用户（免费权限）
  - **VIP**：切换为 VIP 会员（含 4 天 AI 体验期）
  - **SVIP**：切换为 AI 戒烟军师（3 个月 AI 权限）

**权限差异**
| 权限类型 | 全国排名 | AI 助手 | 到期时间 |
|----------|----------|---------|----------|
| 普通用户 | ❌ 仅本地排名 | ❌ | - |
| VIP 会员 | ✅ | ✅ | 4 天 |
| AI 戒烟军师 | ✅ | ✅ | 3 个月 |

**其他设置**
- 查看健康报告：跳转健康报告页
- 关于我们：显示应用介绍
- 隐私政策：显示隐私条款

**交互逻辑**
1. 点击"修改吸烟数据" → 弹出表单 → 修改数据 → 保存 → 提示成功
2. 输入兑换码 → 点击兑换 → 验证码 → 切换权限 → 提示成功

---

### 4.10 排行榜页（RankingPage）

**功能描述**
- 展示全国/本地戒烟天数排名
- 根据权限差异化显示内容

**普通用户视图**
- 标签页：街道排名 / 区排名
- 显示本地排名列表（前 50 名）
- 全国排名显示"🔒 全国排名未开通，去设置兑换码开通"（橙色卡片）
- 点击橙色卡片 → 跳转设置页

**VIP/SVIP 用户视图**
- 标签页：街道排名 / 区排名 / 全国排名
- 全国排名列表：前 100 名
- 自己的排名高亮显示（绿色背景）

**排名数据结构**
- 排名序号
- 用户头像
- 用户昵称
- 戒烟天数
- 段位徽章

**交互逻辑**
1. 点击首页"排行榜"入口 → 跳转排行榜页
2. 切换标签页 → 加载对应排名数据
3. 普通用户点击全国排名锁定卡片 → 跳转设置页
4. 点击分享按钮 → 跳转分享海报页

---

### 4.11 AI 助手页（AIAssistantPage）

**功能描述**
- 提供 AI 对话功能，解答戒烟疑问
- 仅对 VIP/SVIP 用户开放

**权限限制**
- 普通用户：显示"🔒 AI 助手未开通，去设置兑换码开通"
- VIP 会员：可使用 4 天（含到期倒计时提示）
- AI 戒烟军师：可使用 3 个月（含到期日期）

**对话功能**
- 输入框：用户输入问题
- 消息列表：显示对话记录
- AI 回复：模拟 AI 回答戒烟相关问题

**示例问题**
- "我感到很想抽烟怎么办？"
- "戒烟多久身体会恢复正常？"
- "如何克服心理依赖？"

**交互逻辑**
1. 点击首页 AI 助手入口 → 跳转 AI 助手页
2. 输入问题 → 发送 → AI 回复
3. 无权限用户 → 显示锁定状态 → 点击跳转设置页

---

## 五、用户权限体系

### 5.1 权限分类

| 权限类型 | 全国排名 | AI 助手 | 获取方式 | 有效期 |
|----------|----------|---------|----------|--------|
| **普通用户** | ❌ | ❌ | 默认 | 永久 |
| **VIP 会员** | ✅ | ✅ | 兑换码"VIP" | 4 天 AI 体验 |
| **AI 戒烟军师** | ✅ | ✅ | 兑换码"SVIP" | 3 个月 |

### 5.2 权限切换规则
- 通过设置页输入兑换码切换权限
- 兑换码不区分大小写
- 切换为普通用户使用兑换码"ZXO"
- VIP 到期后自动降为普通用户

### 5.3 权限差异化功能

**排行榜页**
- 普通用户：仅显示街道/区排名，全国排名锁定
- VIP/SVIP：显示街道/区/全国排名

**分享海报页**
- 普通用户：显示本地排名 + 全国排名未开通提示
- VIP/SVIP：显示全国排名 + 超越百分比

**AI 助手页**
- 普通用户：锁定状态，显示开通提示
- VIP/SVIP：正常使用，显示到期时间

---

## 六、数据结构

### 6.1 用户数据（UserData）

```typescript
interface UserData {
  nickname: string;              // 昵称
  avatar: string;                // 头像 URL
  setupData: SetupData | null;   // 吸烟数据
  checkInRecords: CheckInRecord[]; // 打卡记录
  cravingRecords: CravingRecord[]; // 烟瘾记录
  makeupCards: number;           // 补签卡数量
  totalDays: number;             // 戒烟总天数
  consecutiveDays: number;       // 连续天数
  lastCheckInDate: string | null; // 最后打卡日期
  lastCravingTime: number | null; // 最后记录烟瘾时间
  hasAgreedToTerms: boolean;     // 是否同意协议
  memberType: 'free' | 'vip' | 'ai'; // 会员类型
  aiExpiryDate?: string | null;  // AI 权限到期日期
}
```

### 6.2 吸烟数据（SetupData）

```typescript
interface SetupData {
  smokingYears: string;      // 吸烟年限（'1年以下', '1-3年', '3-5年', '5-10年', '10年以上'）
  dailyAmount: number;       // 每日吸烟量（根）
  pricePerPack: number;      // 每包价格（元）
  cigarettesPerPack: number; // 每包根数
}
```

### 6.3 打卡记录（CheckInRecord）

```typescript
interface CheckInRecord {
  date: string;       // 日期（YYYY-MM-DD）
  isMakeup: boolean;  // 是否补签
}
```

### 6.4 烟瘾记录（CravingRecord）

```typescript
interface CravingRecord {
  timestamp: number;  // 时间戳
  date: string;       // 日期（YYYY-MM-DD）
  hour: number;       // 小时（0-23）
}
```

### 6.5 统计数据（UserStats）

```typescript
interface UserStats {
  nickname: string;
  avatar: string;
  totalDays: number;           // 戒烟总天数
  consecutiveDays: number;     // 连续天数
  cigarettesAvoided: number;   // 少抽根数
  moneySaved: number;          // 节约金额
  equivalentItem: string;      // 等价物名称
  equivalentCount: number;     // 等价物数量
  equivalentUnit: string;      // 等价物单位
  extraLifeDays: number;       // 多活天数
  extraLifeHours: number;      // 多活小时数
  currentRank: string;         // 当前段位
  rankStars: number;           // 段位星级
  daysToNextRank: number;      // 距离下一段位天数
  nextRank: string;            // 下一段位
  consecutiveTarget: number;   // 连续目标天数
  makeupCards: number;         // 补签卡数量
  last7DaysCheckIn: boolean[]; // 最近 7 天打卡状态
  regionName?: string;         // 区域名称（如"朝阳区"）
  regionRank?: number;         // 区域排名
}
```

---

## 七、核心算法

### 7.1 段位星级计算

```typescript
function getRankByDays(totalDays: number): { rank: string; stars: number } {
  if (totalDays >= 1 && totalDays <= 7) {
    return { rank: '倔强青铜', stars: totalDays };
  }
  if (totalDays >= 8 && totalDays <= 30) {
    return { rank: '秩序白银', stars: totalDays - 7 };
  }
  if (totalDays >= 31 && totalDays <= 60) {
    return { rank: '荣耀黄金', stars: totalDays - 30 };
  }
  if (totalDays >= 61 && totalDays <= 90) {
    return { rank: '尊贵铂金', stars: totalDays - 60 };
  }
  if (totalDays >= 91 && totalDays <= 180) {
    return { rank: '永恒钻石', stars: totalDays - 90 };
  }
  if (totalDays >= 181 && totalDays <= 270) {
    return { rank: '至尊星耀', stars: totalDays - 180 };
  }
  if (totalDays >= 271 && totalDays <= 365) {
    return { rank: '最强王者', stars: totalDays - 270 };
  }
  if (totalDays >= 366 && totalDays <= 547) {
    return { rank: '无双王者', stars: totalDays - 365 };
  }
  if (totalDays >= 548) {
    return { rank: '传奇王者', stars: totalDays - 547 };
  }
  return { rank: '倔强青铜', stars: 0 };
}
```

### 7.2 连续天数计算

```typescript
function calculateConsecutiveDays(checkInRecords: CheckInRecord[]): number {
  if (checkInRecords.length === 0) return 0;
  
  // 按日期排序（从今天往前）
  const sorted = [...checkInRecords].sort((a, b) => 
    new Date(b.date).getTime() - new Date(a.date).getTime()
  );
  
  let consecutive = 0;
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  for (let i = 0; i < sorted.length; i++) {
    const recordDate = new Date(sorted[i].date);
    recordDate.setHours(0, 0, 0, 0);
    
    const expectedDate = new Date(today);
    expectedDate.setDate(expectedDate.getDate() - i);
    
    if (recordDate.getTime() === expectedDate.getTime()) {
      consecutive++;
    } else {
      break; // 中断则停止计算
    }
  }
  
  return consecutive;
}
```

### 7.3 等价物计算

```typescript
const EQUIVALENT_ITEMS = [
  { name: '周边游', price: 15000, unit: '次' },
  { name: '健身年卡', price: 2500, unit: '张' },
  { name: 'Switch 游戏机', price: 2000, unit: '台' },
  { name: '汽车保养', price: 800, unit: '次' },
  { name: '健身月卡', price: 300, unit: '张' },
  { name: '啤酒', price: 120, unit: '箱' },
  { name: '电影票', price: 50, unit: '张' },
  { name: '可乐', price: 3, unit: '瓶' },
];

function calculateEquivalentItem(moneySaved: number): {
  name: string;
  count: number;
  unit: string;
} {
  if (moneySaved <= 0) {
    return { name: '可乐', count: 0, unit: '瓶' };
  }

  // 从高到低遍历，找出第一个满足条件的物品
  for (const item of EQUIVALENT_ITEMS) {
    if (moneySaved >= item.price) {
      return {
        name: item.name,
        count: Math.floor(moneySaved / item.price),
        unit: item.unit
      };
    }
  }

  // 兜底：可乐
  const coke = EQUIVALENT_ITEMS[EQUIVALENT_ITEMS.length - 1];
  return {
    name: coke.name,
    count: Math.floor(moneySaved / coke.price),
    unit: coke.unit
  };
}
```

### 7.4 多活时间计算

```typescript
function calculateExtraLife(cigarettesAvoided: number): {
  days: number;
  hours: number;
} {
  const totalMinutes = cigarettesAvoided * 11; // 每根烟约减少 11 分钟寿命
  const extraLifeDays = Math.floor(totalMinutes / (24 * 60));
  const extraLifeHours = Math.floor((totalMinutes % (24 * 60)) / 60);
  
  return { days: extraLifeDays, hours: extraLifeHours };
}
```

---

## 八、交互流程图

### 8.1 首次使用流程

```
开屏页（3秒）
  ↓
首页（无打卡记录）
  ↓
点击"今日打卡"
  ↓
首次设置弹窗
  ├── 填写吸烟数据
  ├── 勾选同意协议
  └── 点击"开始戒烟之旅"
  ↓
自动完成首次打卡
  ↓
播放咔嗒音效
  ↓
分享海报页
```

### 8.2 日常打卡流程

```
首页
  ↓
点击"今日打卡"
  ↓
检查是否已打卡
  ├── 已打卡 → 提示"今天已经打卡过了"
  └── 未打卡 ↓
  ↓
更新打卡记录
  ↓
播放咔嗒音效
  ↓
检查是否晋升段位
  ├── 晋升 → 显示晋升提示（2.5秒）→ 跳转分享海报页
  └── 未晋升 → 直接跳转分享海报页
```

### 8.3 补签流程

```
首页
  ↓
点击"连续打卡"入口
  ↓
连续打卡日历页
  ↓
点击未打卡日期
  ↓
检查补签条件
  ├── 补签卡不足 → 提示"补签卡不足"
  ├── 今日已补签2次 → 提示"每日最多补签2天"
  ├── 该日期已打卡 → 提示"该日期已经打卡"
  └── 通过检查 ↓
  ↓
弹出补签确认
  ↓
点击确认
  ↓
消耗1张补签卡
  ↓
添加补签记录
  ↓
重新计算连续天数
  ↓
播放咔嗒音效
  ↓
检查是否晋升段位
  ├── 晋升 → 显示晋升提示
  └── 未晋升 → 显示"补签成功"提示
```

### 8.4 烟瘾记录流程

```
首页
  ↓
点击 ZXO Logo
  ↓
播放咔嗒音效
  ↓
检查距离上次记录是否 < 10 分钟
  ├── < 10 分钟 → 只播放音效，不记录
  └── ≥ 10 分钟 ↓
  ↓
记录烟瘾数据
  ↓
显示"本次烟瘾已记录"提示
  ↓
检查点击次数
  └── 连续三次点击 → 跳转数据报告页
```

### 8.5 权限切换流程

```
设置页
  ↓
输入兑换码
  ├── "ZXO" → 切换为普通用户
  ├── "VIP" → 切换为 VIP 会员（4 天 AI 体验）
  └── "SVIP" → 切换为 AI 戒烟军师（3 个月）
  ↓
点击"兑换"按钮
  ↓
验证兑换码
  ├── 无效 → 提示"兑换码无效"
  └── 有效 ↓
  ↓
更新用户权限
  ↓
设置到期时间
  ↓
显示切换成功提示
```

---

## 九、视觉设计规范

### 9.1 配色方案

| 颜色名称 | Hex 值 | 用途 |
|----------|--------|------|
| 背景色 | #EFEFEF | 页面主背景 |
| 卡片背景 | #FFFFFF | 卡片、弹窗背景 |
| 主文本色 | #2A2A2A | 标题、正文 |
| 次要文本色 | #999999 | 提示文字 |
| 主题绿色 | #00B894 | 按钮、高亮、打卡标记 |
| 锁定橙色 | #F59E0B | 未开通功能提示 |
| 补签橙色 | #F59E0B | 补签记录标记 |
| 禁用灰色 | #BDBDBD | 禁用按钮、未达成项 |

### 9.2 字体规范

- **字体家族**：中文黑体（sans-serif）
- **数字样式**：全部加粗（font-weight: bold）
- **标题字号**：
  - 页面标题：24px
  - 卡片标题：18px
  - 数据标签：14px
- **正文字号**：
  - 正文：16px
  - 提示：12px

### 9.3 间距规范

- **页面边距**：16px
- **卡片间距**：12px
- **内容内边距**：16px
- **按钮高度**：48px
- **圆角大小**：
  - 按钮：8px
  - 卡片：12px
  - 头像：50%（圆形）

### 9.4 组件样式

**按钮**
- 主按钮（打卡）：绿色背景 #00B894，白色文字，48px 高度
- 次要按钮（返回）：透明背景，绿色边框，绿色文字
- 禁用按钮：灰色背景 #BDBDBD，白色文字

**卡片**
- 白色背景 #FFFFFF
- 圆角 12px
- 阴影：0 2px 8px rgba(0, 0, 0, 0.1)

**徽章**
- 段位徽章：圆形，绿色边框，绿色图标
- 星级：⭐ 符号，数字加粗

**标记**
- 已打卡：绿色圆点
- 补签：橙色圆点
- 未打卡：无标记

---

## 十、技术实现要点

### 10.1 技术栈

- **框架**：React
- **样式**：Tailwind CSS v4.0
- **动画**：Motion（Framer Motion）
- **图表**：Recharts
- **图标**：Lucide React
- **状态管理**：React Hooks（useState、useEffect）
- **音效**：Web Audio API

### 10.2 核心技术点

**音效实现**
- 使用 Web Audio API 生成咔嗒音效
- 两段音效叠加（2000Hz + 800Hz）
- 点击时播放，增强反馈感

**数据持久化**
- 使用 localStorage 保存用户数据
- 每次操作后自动保存
- 页面刷新后恢复数据

**日期计算**
- 使用 Date 对象处理日期
- 所有日期统一格式为 YYYY-MM-DD
- 时区处理：统一使用本地时区

**权限到期检查**
- VIP：4 天后自动到期
- AI：3 个月后自动到期
- 实时检查到期状态（每次页面渲染）

**烟瘾记录限制**
- 使用 timestamp 记录时间
- 10 分钟内不重复记录
- 三次点击跳转逻辑（10 秒内有效）

### 10.3 性能优化

- 使用 React.memo 优化组件渲染
- 列表使用唯一 key 值
- 图表数据按需加载
- 图片懒加载

### 10.4 兼容性

- 支持现代浏览器（Chrome、Safari、Edge、Firefox）
- 响应式设计（移动端优先）
- 不支持 IE

---

## 十一、数据埋点与分析

### 11.1 关键指标

**用户留存**
- 次日留存率
- 7 日留存率
- 30 日留存率

**行为数据**
- 打卡次数
- 补签次数
- 烟瘾记录次数
- 分享次数
- 段位分布

**转化数据**
- 兑换码使用率
- VIP 转化率
- AI 使用率

### 11.2 埋点事件

| 事件名称 | 触发时机 | 参数 |
|----------|----------|------|
| page_view | 页面访问 | page_name |
| check_in | 打卡成功 | is_first_time |
| makeup_card_use | 使用补签卡 | remaining_cards |
| rank_up | 段位晋升 | new_rank, total_days |
| craving_record | 记录烟瘾 | hour, date |
| share_poster | 分享海报 | total_days, rank |
| redeem_code | 兑换码使用 | code_type |
| ai_chat | AI 对话 | question_type |

---

## 十二、未来规划

### 12.1 版本迭代计划

**v2.1（近期）**
- 社交功能：好友系统、互相监督
- 成就系统：徽章收集、里程碑奖励
- 数据导出：导出戒烟报告 PDF

**v2.2（中期）**
- 社区功能：经验分享、戒烟日记
- 个性化推荐：根据烟瘾曲线推荐应对策略
- 提醒功能：定时鼓励、烟瘾预警

**v3.0（长期）**
- 多端同步：小程序、APP、Web 数据同步
- 智能辅助：AI 分析烟瘾模式，个性化建议
- 线下活动：戒烟打卡挑战赛、线下聚会

### 12.2 商业化探索

- 会员订阅：VIP/SVIP 月费/年费
- 广告合作：健康产品、健身服务
- 企业定制：企业戒烟计划服务

---

## 十三、风险与应对

### 13.1 数据安全

**风险**：用户数据泄露、隐私侵犯
**应对**：
- 数据加密存储
- 不收集敏感个人信息
- 明确隐私政策

### 13.2 用户流失

**风险**：戒烟失败、中断后放弃
**应对**：
- 补签卡机制降低流失
- 鼓励性文案减少挫败感
- 社交功能增强粘性

### 13.3 内容合规

**风险**：健康数据误导、医疗建议违规
**应对**：
- 所有健康数据标注"仅供参考"
- 不提供医疗诊断建议
- 鼓励用户咨询专业医生

---

## 十四、附录

### 14.1 兑换码规则

| 兑换码 | 权限类型 | 有效期 | 说明 |
|--------|----------|--------|------|
| ZXO | 普通用户 | 永久 | 恢复为免费用户 |
| VIP | VIP 会员 | 4 天 AI 体验 | 包含全国排名 + AI 助手 |
| SVIP | AI 戒烟军师 | 3 个月 | 完整 AI 功能 |

### 14.2 段位晋升文案

| 段位 | 打卡文案 | 晋升文案 |
|------|----------|----------|
| 倔强青铜 | 今天的你，赢了欲望。 | 加油！争取成功度过最难熬的头 7 天。每天不吸烟就是一场胜利。 |
| 秩序白银 | 习惯在重塑，意志在生长。 | 身体开始清除尼古丁，习惯开始被打破。坚持每天打卡。 |
| 荣耀黄金 | 坚持一个月，你的呼吸变轻盈了。 | 生理依赖显著减弱。坚持一个月不吸烟，值得一枚"金牌"。 |
| 尊贵铂金 | 你的身体正在恢复健康。 | 恭喜！你已成功克服了最强烈的生理依赖，戒烟习惯初步形成。 |
| 永恒钻石 | 心瘾最强时，信念最亮。 | 名声在外的"钻石坑"，极易因心瘾和诱惑而"掉星"（复吸）。稳住心态！ |
| 至尊星耀 | 半年无烟，你已让意志发光。 | 已经半年多不吸烟，信心大增。但依然不能松懈。 |
| 最强王者 | 你是生活中的王者。 | 里程碑达成！坚持戒烟满一年，你已经是生活中的"王者"。 |
| 无双王者 | 无感于烟，自由于心。 | 对烟草的渴望已非常微弱，在各种场合都能坦然拒绝敬烟。 |
| 传奇王者 | 两年坚持，自由呼吸的传奇。 | 登顶！你不再是一个"戒烟者"，而是一个"不吸烟的人"。 |

### 14.3 等价物兑换表

| 物品 | 价格（元） | 单位 |
|------|-----------|------|
| 周边游 | 15000 | 次 |
| 健身年卡 | 2500 | 张 |
| Switch 游戏机 | 2000 | 台 |
| 汽车保养 | 800 | 次 |
| 健身月卡 | 300 | 张 |
| 啤酒 | 120 | 箱 |
| 电影票 | 50 | 张 |
| 可乐 | 3 | 瓶 |

---

**文档结束**

---

## 变更记录

| 版本 | 日期 | 修改内容 | 修改人 |
|------|------|----------|--------|
| v1.0 | 2025-11-15 | 初版创建，深色主题 | - |
| v2.0 | 2025-12-01 | 切换为浅色主题，调整配色方案，优化权限体系 | - |
